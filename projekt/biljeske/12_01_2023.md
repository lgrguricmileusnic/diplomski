- https://github.com/GENIVI/CANdevStudio
- https://aur.archlinux.org/packages/candevstudio-git

Instalacija iz AUR-a:
```
$ yay candevstudio-git
```


Primjer projekta:
![[projekt_candevstudio.png]]

- projekt je spremljen u plaintext JSON formatu, kao lista cvorova "nodes" i lista njihovih veza "connections"
- cvorovi sadrze podatke poput tipa cvora, pozicije na ekranu, boje i konfiguracije
	- primjerice CanDevice cvor ce sadrzavati opis uredjaja (bio hardverski ili vcan interface), QMLExecutor ce sadrzavati putanju do qml file-a koji opisuje Qt sucelje i logiku koja se izvrsava


```json test_projekt.cds
{
    "connections": [
        {
            "in_id": "{284222a1-1869-4fee-b3d8-ad50dd7bfb74}",
            "in_index": 0,
            "out_id": "{b5f7c311-4de4-4c7b-9e5b-328a5d4ed832}",
            "out_index": 0
        },
        {
            "in_id": "{284222a1-1869-4fee-b3d8-ad50dd7bfb74}",
            "in_index": 1,
            "out_id": "{cba4248f-e115-4af7-8b7e-bdafee264b4f}",
            "out_index": 0
        },
        {
            "in_id": "{cba4248f-e115-4af7-8b7e-bdafee264b4f}",
            "in_index": 0,
            "out_id": "{b5f7c311-4de4-4c7b-9e5b-328a5d4ed832}",
            "out_index": 0
        },
        {
            "in_id": "{b5f7c311-4de4-4c7b-9e5b-328a5d4ed832}",
            "in_index": 0,
            "out_id": "{524f05a9-8361-4fee-9446-21a54675d12d}",
            "out_index": 0
        },
        {
            "in_id": "{524f05a9-8361-4fee-9446-21a54675d12d}",
            "in_index": 0,
            "out_id": "{de5b4df0-baf6-498f-8d98-fa64d9043451}",
            "out_index": 0
        },
        {
            "in_id": "{de5b4df0-baf6-498f-8d98-fa64d9043451}",
            "in_index": 0,
            "out_id": "{6fff0058-62bd-457c-bae7-098c05162432}",
            "out_index": 0
        }
    ],
    "nodes": [
        {
            "id": "{284222a1-1869-4fee-b3d8-ad50dd7bfb74}",
            "model": {
                "QML file": null,
                "caption": "QMLExecutor #14",
                "name": "QMLExecutor"
            },
            "position": {
                "x": 1381,
                "y": 237
            }
        },
        {
            "id": "{b5f7c311-4de4-4c7b-9e5b-328a5d4ed832}",
            "model": {
                "caption": "CanRawFilter #12",
                "name": "CanRawFilter",
                "rxList": [
                    {
                        "id": ".*",
                        "payload": ".*",
                        "policy": true
                    }
                ],
                "txList": [
                    {
                        "id": ".*",
                        "payload": ".*",
                        "policy": true
                    }
                ]
            },
            "position": {
                "x": 911,
                "y": 254
            }
        },
        {
            "id": "{cba4248f-e115-4af7-8b7e-bdafee264b4f}",
            "model": {
                "CAN database": null,
                "caption": "CanSignalDecoder #11",
                "color": "#9CD59B",
                "name": "CanSignalDecoder"
            },
            "position": {
                "x": 1133,
                "y": 487
            }
        },
        {
            "id": "{524f05a9-8361-4fee-9446-21a54675d12d}",
            "model": {
                "backend": "virtualcan",
                "caption": "CanDevice #10",
                "configuration": "",
                "interface": "can0",
                "name": "CanDevice"
            },
            "position": {
                "x": 643,
                "y": 123
            }
        },
        {
            "id": "{6fff0058-62bd-457c-bae7-098c05162432}",
            "model": {
                "CAN database": null,
                "caption": "CanSignalSender #8",
                "color": "#9CD59B",
                "name": "CanSignalSender",
                "rows": [
                    {
                        "id": "",
                        "sig": "",
                        "val": ""
                    }
                ]
            },
            "position": {
                "x": 185,
                "y": 487
            }
        },
        {
            "id": "{1a82a718-9fcd-407b-8004-c61a1fe0aaa5}",
            "model": {
                "caption": "CanSignalData #7",
                "color": "#9CD59B",
                "file": null,
                "msgSettings": [
                ],
                "name": "CanSignalData"
            },
            "position": {
                "x": 279,
                "y": 279
            }
        },
        {
            "id": "{de5b4df0-baf6-498f-8d98-fa64d9043451}",
            "model": {
                "CAN database": null,
                "caption": "CanSignalEncoder #6",
                "color": "#9CD59B",
                "name": "CanSignalEncoder"
            },
            "position": {
                "x": 453,
                "y": 359
            }
        }
    ]
}

```

#### Komponente

Can device komponenta
- sucelje za slanje i primanje CAN prometa kroz vcan, canelloni ili nekom od upravljackih programa za CAN transceiver (proizvodjaci PEAK, VECTOR ...)
**Raw** sloj:
- CanLoad - prikazuje opterecenost sabirnice
- CanRawFilter - filtriranje CAN frameova
- CanRawLogger - logging CAN prometa u datoteku
- CanRawPlayer i CanRawSender
	- sluze za reprodukciju CAN frameova iz datoteke ili slanje CAN okvira u intervalima
- CanRawView - prikaz CAN prometa

**Signal** sloj:
- CanSignalData - referenca na dbc datoteku koja se moze koristiti u drugim Signal komponentama
- CanSignalEncoder i CanSignalDecoder - pretvaranje "raw" CAN frameova u ljudski citljive signale prema specificiranom DBC fileu i obrnuto
- CanSignalSender - kao i CanRawSender, samo se specificiraju vrijednosti u kontekstu signala, a ne direktno CAN frameovi binarno
- CanSignalViewer

Misc - QMLExecutor
### Skripte i prilagodjene komponente - QMLExecutor
Nema puno dokumentacije sto se tice stvaranja prilagodjenih komponenti osim par primjera. 

Za pisanje GUI-a komponente koristi se [QML](https://doc.qt.io/qt-5/qmlapplications.html).

Primjeri:
https://github.com/GENIVI/CANdevStudio/tree/master/src/components/qmlexecutor/examples

Model preko kojeg se dohvacaju i salju CAN okviri i signali:
https://github.com/GENIVI/CANdevStudio/blob/3b51e48196949469495138b6323a054c12013138/src/components/qmlexecutor/canbusmodel.hpp

Problem s pokretanjem primjera:
```
Loading qml file: /home/lgm/fer/diplomski/projekt/kod/candevstudio/test_projekt/sample.qml

QML status: error - file:///home/lgm/fer/diplomski/projekt/kod/candevstudio/test_projekt/sample.qml:3:1: module "QtQuick.Controls" is not installed

Loading qml file: /home/lgm/fer/diplomski/projekt/kod/candevstudio/test_projekt/simple_forwarder.qml

QML status: error - file:///home/lgm/fer/diplomski/projekt/kod/candevstudio/test_projekt/simple_forwarder.qml:1:1: Expected a qualified name id

Loading qml file: /home/lgm/fer/diplomski/projekt/kod/candevstudio/test_projekt/simple_timer.qml

QML status: error - file:///home/lgm/fer/diplomski/projekt/kod/candevstudio/test_projekt/simple_timer.qml:1:1: Expected a qualified name id

```

Pretpostavljam da nemam instalirane neke Qt biblioteke ili je doslo do promjene u sintaksi u odnosu na verziju u kojoj su primjeri pisani. Nisam htio gubiti vrijeme na osposobljavanje ovoga jer je iz koda lako iscitati funkcionalnost.

QMLExecutor omogucava pisanje komponenti koje obradjuju ili reagiraju na primljeni CAN raw ili signal promet. Takodjer mogu ga i samo stvarati, primjerice kad bi htjeli napisati komponentu koja emulira volan ili neku drugu kontrolu u automobilu. Cini mi se da nema ogranicenja kod stvaranja grafickih sucelja, osim koje ima i sam Qt.

### Primjena za diplomski projekt
Alat je vise specijaliziran za debugiranje i pregledavanje CAN prometa te simulaciju, nego za samu emulaciju CAN-a (mreze). Vrlo modularan zbog QMLExecutor komponente, ali komunikacija preko CANBusModela bi mogla biti ogranicavajuca.

Korisnicko sucelje nije idealno za stvaranje mreze uredjaja, obzirom da ne postoji komponenta koja predstavlja CAN sabirnicu, vec bi se svi cvorovi trebali povezivat medjusobno.

## Koncept modularnog simulatora CAN mre≈æe

### Izvedba 1 - ECU-ovi kao procesi/threadovi





### Izvedba 2 - ECU-ovi kao Docker kontenjeri
#### Opcija A
#### Opcija B


