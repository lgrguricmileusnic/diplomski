## 22.4.

preostalo
- driver
	- dodat opciju za povezivanje dockercan namespacea na defaultni
	- dodat opciju za imenovanje dockercan namespacea
- ecu_template
	- povezat s nekim GUI-jem
	- KUKSA server
- skripta za generiranje composeova
- zadaci

Kako omoguciti caringcaribou da prepozna uds servis?

iz uds.py discovery modula caring cariboua:

```python
    diagnostic_session_control = Services.DiagnosticSessionControl
    service_id = diagnostic_session_control.service_id
    sub_function = diagnostic_session_control.DiagnosticSessionType.DEFAULT_SESSION
    session_control_data = [service_id, sub_function]

	valid_session_control_responses = [0x50, 0x7F]
```

Salje DiagnosticSessionControl poruke na koje je potrebno pozitivno ili negativno odgovoriti.



```
❯ caringcaribou uds discovery -max 0x200

-------------------
CARING CARIBOU v0.6 - python 3.11.8 (main, Feb 12 2024, 14:50:05) [GCC 13.2.1 20230801]
-------------------

Loading module 'uds'

Sending Diagnostic Session Control to 0x0100
  Verifying potential response from 0x0100
    Resending 0x100...  Success
Found diagnostics server listening at 0x0100, response at 0x0101
Sending Diagnostic Session Control to 0x0200

Identified diagnostics:

+------------+------------+
| CLIENT ID  | SERVER ID  |
+------------+------------+
| 0x00000100 | 0x00000101 |
+------------+------------+

```

Sto je potrebno dodati:
```python
class UDSHandlerImpl(UDSHandler):
    def __init__(self, ecu: ECUModel):
        super().__init__(
            ecu,
        )

    def handle_msg(self, msg: UDS):
        match msg.payload:
            case UDS_ER():
                self.isotp.send(UDS() / UDS_ERPR(resetType=msg.resetType))
            case UDS_DSC(): # ovo
                self.isotp.send(
                    UDS() / UDS_DSCPR(diagnosticSessionType=msg.diagnosticSessionType)
                )
```

### UDS_RMBA

![[RMBA_flow_example.png]]

drugi oktet odredjuje format ostatka poruke, npr 24h -> 2 okteta za size, 4 okteta za adresu